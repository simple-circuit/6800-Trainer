
M68HC11 Absolute Assembler   Version 2.70C:chsclk.ASC


   1 A 0000                                                      
   2 A      00E4       TEMP      EQU       $00E4                 
   3 A      00E7       ADDR      EQU       $00E7                 
   4 A      00E9       FLAG      EQU       $00E9                 
   5 A      00EA       BRKADD    EQU       $00EA                 
   6 A      00EC       BRKOP     EQU       $00EC                 
   7 A 0000                                                      
   8 A                 *I/O FUNCTIONS 
   9 A      FC00       RESET     EQU       $FC00                 
  10 A      FC8A       PRTSTR    EQU       $FC8A                 
  11 A      FCC3       GETKEY    EQU       $FCC3                 
  12 A      FCDA       MKASCI    EQU       $FCDA                 
  13 A      FCE4       GET2H     EQU       $FCE4                 
  14 A      FD05       GET4H     EQU       $FD05                 
  15 A      FD28       CHG2H     EQU       $FD28                 
  16 A      FD2B       CH2HNP    EQU       $FD2B                 
  17 A      FDF8       CHG4H     EQU       $FDF8                 
  18 A      FE90       PRTDAT    EQU       $FE90                 
  19 A      FE90       PRTADD    EQU       $FE90                 
  20 A      FB70       OUTCH     EQU       $FB70                 
  21 A      FBEA       OUT2H     EQU       $FBEA                 
  22 A 0000                                                      
  23 A                 *VECTOR ENTRY POINTS 
  24 A      0103       IRQV      EQU       $0103                 
  25 A      0100       SWIV      EQU       $0100                 
  26 A      0106       NMIV      EQU       $0106                 
  27 A      FC00       RESETV    EQU       $FC00                 
  28 A 0000                                                      
  29 A                 *SPECIAL OP CODES 
  30 A                 *S1 IS SYSTEM STACK AND S2 IS USER STACK 
  31 A      0002       SS2       EQU       $02                   *SINGLE STEP: RS2, EXECUTE OP CODE, RS1 
  32 A      0003       TX2       EQU       $03                   *TRANSFER X TO S2 
  33 A      0004       T2X       EQU       $04                   *TRANSFER S2 TO X 
  34 A      0005       RS2       EQU       $05                   *SWI S1 THEN RTI TO S2 
  35 A      0015       RS1       EQU       $15                   *SWI S2 THEN RTI TO S1 
  36 A      0012       TON       EQU       $12                   *TURN TRACE ON (OUTPUT TO SERIAL AND SERIAL1) 
  37 A      0013       TOF       EQU       $13                   *TURN TRACE OFF 
  38 A 0000                                                      
  39 A                 * UART Status 0xF000 Read Only, Bit-1 Transmit Ready, Bit-0 Receive Ready 
  40 A                 *      Use: LDAA $F000 or LDAB $F000 
  41 A                 * UART Write Data 0xF001 
  42 A                 *      Use: STAA $F001 or STAB $F001 
  43 A                 * UART Read Data 0xF003 
  44 A                 *      Use: LDAA $F003, LDAB $F003, or ANDB $F003 
  45 A                 * I/O Data In at 0xF011 Digital pins D0 to D7 
  46 A                 *     Use: Any load instruction, maps to memory 
  47 A                 * I/O Data Out at 0xF010 Digital pins D8 to D15 
  48 A                 *     Use: STAB $F010 
  49 A                 * ADC Start Read at 0xF020 
  50 A                 *     Use: LDAB #ch then STAB $F020 where ch = 1 to 3 
  51 A                 * ADC High Byte at 0xF020, ADC Low Byte at 0xF021 
  52 A                 *     Use: Any load instruction, maps to memory  
  53 A                  
  54 A      F000       UARTST    EQU       $F000                 
  55 A      F001       UARTWR    EQU       $F001                 
  56 A      F003       UARTRD    EQU       $F003                 
  57 A      F010       IOWR      EQU       $F010                 
  58 A      F011       IORD      EQU       $F011                 

M68HC11 Absolute Assembler   Version 2.70C:chsclk.ASC


  59 A      F020       ADCWR     EQU       $F020                 
  60 A      F020       ADCRD     EQU       $F020                 
  61 A 0000                                                      
  62 A                 *KEY PAD INPUT 
  63 A                 *$C000 = $FF FOR NO KEY PRESSED AND $00 TO $10 FOR KEY(S) PRESSED 
  64 A                 *$C003 = KEY COLUMN-3 3,6,9,C,F  BIT DATA IS LOW FOR PRESSED KEY 
  65 A                 *$C005 = KEY COLUMN-2 2,5,8,B,E  BIT DATA IS LOW FOR PRESSED KEY 
  66 A                 *$C006 = KEY COLUMN-1 0,1,4,7,A,D BIT DATA IS LOW FOR PRESSED KEY 
  67 A 0000                                                      
  68 A      C000       KEYIN     EQU       $C000                 
  69 A      C006       KEYC1     EQU       $C006                 
  70 A      C005       KEYC2     EQU       $C005                 
  71 A      C003       KEYC3     EQU       $C003                 
  72 A 0000                                                      
  73 A                 *LCD DISPLAY 
  74 A                 *$C100 = ASCII VALUE FOR LEFT MOST DIGIT, WRITE ZERO TO USE SEGMENT BIT MODE 
  75 A                 *$C101 = ASCII VALUE FOR NEXT DIGIT, WRITE ZERO TO USE SEGMENT BIT MODE 
  76 A                 *$C102 = ASCII VALUE FOR NEXT DIGIT, WRITE ZERO TO USE SEGMENT BIT MODE 
  77 A                 *$C103 = ASCII VALUE FOR NEXT DIGIT, WRITE ZERO TO USE SEGMENT BIT MODE 
  78 A                 *$C104 = ASCII VALUE FOR NEXT DIGIT, WRITE ZERO TO USE SEGMENT BIT MODE 
  79 A                 *$C105 = ASCII VALUE FOR NEXT DIGIT, WRITE ZERO TO USE SEGMENT BIT MODE 
  80 A                 *$C106 = ASCII VALUE FOR NEXT DIGIT, WRITE ZERO TO USE SEGMENT BIT MODE 
  81 A                 *$C107 = ASCII VALUE FOR RIGHT MOST DIGIT, WRITE ZERO TO USE BIT MODE 
  82 A                 *$C110 = g, $C111 = f, ..., $C117 = d.p. SEGMENT FOR LEFT MOST DIGIT 
  83 A                 *$WRITE $01 TO SET SEGMENT, $00 TO CLEAR 
  84 A                 *REMAINING DIGITS $C120, $C130, $C140, $C150, $C160, $C170, $C180 
  85 A 0000                                                      
  86 A      C100       ASCI0     EQU       $C100                 
  87 A      C101       ASCI1     EQU       $C101                 
  88 A      C102       ASCI2     EQU       $C102                 
  89 A      C103       ASCI3     EQU       $C103                 
  90 A      C104       ASCI4     EQU       $C104                 
  91 A      C105       ASCI5     EQU       $C105                 
  92 A      C106       ASCI6     EQU       $C106                 
  93 A      C107       ASCI7     EQU       $C107                 
  94 A      C110       SG0       EQU       $C110                 
  95 A      C120       SG1       EQU       $C120                 
  96 A      C130       SG2       EQU       $C130                 
  97 A      C140       SG3       EQU       $C140                 
  98 A      C150       SG4       EQU       $C150                 
  99 A      C160       SG5       EQU       $C160                 
 100 A      C170       SG6       EQU       $C170                 
 101 A      C180       SG7       EQU       $C180                 
 102 A 0000                                                      
 103 A      0106                 ORG       NMIV                  
 104 A 0106 7E0110               JMP       IRQS                  
 105 A 0109                                                      
 106 A      0110                 ORG       $0110                 
 107 A 0110 7D0006     IRQS      TST       FLG                   
 108 A 0113 270C                 BEQ       RET0                  
 109 A 0115 2B05                 BMI       ITS2                  
 110 A 0117 CE0000               LDX       #ADR1                 
 111 A 011A 2006                 BRA       OVER                  
 112 A 011C CE0003     ITS2      LDX       #ADR2                 
 113 A 011F 2001                 BRA       OVER                  
 114 A 0121 3B         RET0      RTI                             
 115 A 0122 6A02       OVER      DEC       2,X                   
 116 A 0124 26FB                 BNE       RET0                  

M68HC11 Absolute Assembler   Version 2.70C:chsclk.ASC


 117 A 0126 863C                 LDAA      #60                   
 118 A 0128 A702                 STAA      2,X                   
 119 A 012A 8699                 LDAA      #$99                  
 120 A 012C AB01                 ADDA      1,X                   
 121 A 012E 19                   DAA                             
 122 A 012F 8199                 CMPA      #$99                  
 123 A 0131 2604                 BNE       NOMIN                 
 124 A 0133 8659                 LDAA      #$59                  
 125 A 0135 6A00                 DEC       0,X                   
 126 A 0137 A701       NOMIN     STAA      1,X                   
 127 A 0139 A600                 LDAA      0,X                   
 128 A 013B 2A05                 BPL       PRTTIM                
 129 A 013D 4F                   CLRA                            
 130 A 013E A700                 STAA      0,X                   
 131 A 0140 A701                 STAA      1,X                   
 132 A 0142 860D       PRTTIM    LDAA      #$0D                  
 133 A 0144 BDFB70               JSR       OUTCH                 
 134 A 0147 B60000               LDAA      ADR1                  
 135 A 014A BDFCDA               JSR       MKASCI                
 136 A 014D BDFB70               JSR       OUTCH                 
 137 A 0150 B60001               LDAA      ADR1+1                
 138 A 0153 BDFBEA               JSR       OUT2H                 
 139 A 0156 8620                 LDAA      #$20                  
 140 A 0158 BDFB70               JSR       OUTCH                 
 141 A 015B BDFB70               JSR       OUTCH                 
 142 A 015E B60003               LDAA      ADR2                  
 143 A 0161 BDFCDA               JSR       MKASCI                
 144 A 0164 BDFB70               JSR       OUTCH                 
 145 A 0167 B60004               LDAA      ADR2+1                
 146 A 016A BDFBEA               JSR       OUT2H                 
 147 A 016D 865F                 LDAA      #'_                   
 148 A 016F 7D0006               TST       FLG                   
 149 A 0172 2B04                 BMI       PLR2                  
 150 A 0174 B7C103               STAA      ASCI3                 
 151 A 0177 3B                   RTI                             
 152 A 0178 B7C104     PLR2      STAA      ASCI4                 
 153 A 017B 3B                   RTI                             
 154 A 017C                                                      
 155 A      0200                 ORG       $0200                 
 156 A 0200 CE0000     START     LDX       #$0000                
 157 A 0203 6F01                 CLR       1,X                   
 158 A 0205 6F04                 CLR       4,X                   
 159 A 0207 6F06                 CLR       6,X                   
 160 A 0209 863C                 LDAA      #$3C                  
 161 A 020B A702                 STAA      2,X                   
 162 A 020D A705                 STAA      5,X                   
 163 A 020F 8605                 LDAA      #$05                  
 164 A 0211 A700                 STAA      0,X                   
 165 A 0213 A703                 STAA      3,X                   
 166 A 0215 860A                 LDAA      #$0A                  
 167 A 0217 BDFB70               JSR       OUTCH                 
 168 A 021A BDFCC3     GKEY      JSR       GETKEY                
 169 A 021D 4D                   TSTA                            
 170 A 021E 2707                 BEQ       ISF                   
 171 A 0220 8601                 LDAA      #$01                  
 172 A 0222 B70006               STAA      FLG                   
 173 A 0225 20F3                 BRA       GKEY                  
 174 A 0227 8682       ISF       LDAA      #$82                  

M68HC11 Absolute Assembler   Version 2.70C:chsclk.ASC


 175 A 0229 B70006               STAA      FLG                   
 176 A 022C 20EC                 BRA       GKEY                  
 177 A 022E                                                      
 178 A 022E                                                      
 179 A 022E                                                      
 180 A      0000       ADR1      EQU       $0000                 
 181 A      0003       ADR2      EQU       $0003                 
 182 A      0006       FLG       EQU       $0006                 
 183 A 022E                                                      
 184 A 022E                                                      
 185 A                           END                             

SYMBOL TABLE:  Total Entries=   69

ADCRD               F020    NMIV                0106
ADCWR               F020    NOMIN               0137
ADDR                00E7    OUT2H               FBEA
ADR1                0000    OUTCH               FB70
ADR2                0003    OVER                0122
ASCI0               C100    PLR2                0178
ASCI1               C101    PRTADD              FE90
ASCI2               C102    PRTDAT              FE90
ASCI3               C103    PRTSTR              FC8A
ASCI4               C104    PRTTIM              0142
ASCI5               C105    RESET               FC00
ASCI6               C106    RESETV              FC00
ASCI7               C107    RET0                0121
BRKADD              00EA    RS1                 0015
BRKOP               00EC    RS2                 0005
CH2HNP              FD2B    SG0                 C110
CHG2H               FD28    SG1                 C120
CHG4H               FDF8    SG2                 C130
FLAG                00E9    SG3                 C140
FLG                 0006    SG4                 C150
GET2H               FCE4    SG5                 C160
GET4H               FD05    SG6                 C170
GETKEY              FCC3    SG7                 C180
GKEY                021A    SS2                 0002
IORD                F011    START               0200
IOWR                F010    SWIV                0100
IRQS                0110    T2X                 0004
IRQV                0103    TEMP                00E4
ISF                 0227    TOF                 0013
ITS2                011C    TON                 0012
KEYC1               C006    TX2                 0003
KEYC2               C005    UARTRD              F003
KEYC3               C003    UARTST              F000
KEYIN               C000    UARTWR              F001
MKASCI              FCDA    

Total errors: 0
